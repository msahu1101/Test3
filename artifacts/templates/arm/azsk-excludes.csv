ControlId,FeatureName,Status,SupportedResources,Severity,PropertyPath,LineNumber,CurrentValue,ExpectedProperty,ExpectedValue,ResourcePath,ResourceLineNumber,Description,FilePath
Azure_AppService_Audit_Enable_Logging_and_Monitoring,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.requestTracingEnabled | $.properties.requestTracingEnabled,'True',"resources[0] , resources[0]",32,Auditing and Monitoring must be enabled for App Service,.\app-service.json
Azure_AppService_Audit_Enable_Logging_and_Monitoring,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.httpLoggingEnabled | $.properties.httpLoggingEnabled,'True',"resources[0] , resources[0]",32,Auditing and Monitoring must be enabled for App Service,.\app-service.json
Azure_AppService_Audit_Enable_Logging_and_Monitoring,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.detailedErrorLoggingEnabled | $.properties.detailedErrorLoggingEnabled,'True',"resources[0] , resources[0]",32,Auditing and Monitoring must be enabled for App Service,.\app-service.json
Azure_AppService_Audit_Enable_Logging_and_Monitoring,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,resources[1].properties.requestTracingEnabled,103,FALSE,$.properties.siteConfig.requestTracingEnabled | $.properties.requestTracingEnabled,'True',resources[1],87,Auditing and Monitoring must be enabled for App Service,.\app-service.json
Azure_AppService_Audit_Enable_Logging_and_Monitoring,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,resources[1].properties.httpLoggingEnabled,106,FALSE,$.properties.siteConfig.httpLoggingEnabled | $.properties.httpLoggingEnabled,'True',resources[1],87,Auditing and Monitoring must be enabled for App Service,.\app-service.json
Azure_AppService_Audit_Enable_Logging_and_Monitoring,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,resources[1].properties.detailedErrorLoggingEnabled,108,FALSE,$.properties.siteConfig.detailedErrorLoggingEnabled | $.properties.detailedErrorLoggingEnabled,'True',resources[1],87,Auditing and Monitoring must be enabled for App Service,.\app-service.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthEnabled | $.properties.siteAuthEnabled,'True',"resources[0] , resources[0]",32,App Service must authenticate users using Azure Active Directory backed credentials,.\app-service.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthSettings.clientId | $.properties.siteAuthSettings.clientId,Non-null string,"resources[0] , resources[0]",32,App Service must authenticate users using Azure Active Directory backed credentials,.\app-service.json
Azure_AppService_AuthN_Use_Managed_Service_Identity,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.identity.type,Allow 'SystemAssigned',"resources[0] , resources[0]",32,Use Managed Service Identity (MSI) for accessing other AAD-protected resources from the app service.,.\app-service.json
Azure_AppService_BCDR_Use_AlwaysOn,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.alwaysOn | $.properties.alwaysOn,'True',"resources[0] , resources[0]",32,'Always On' should be configured for App Service,.\app-service.json
Azure_AppService_BCDR_Use_Multiple_Instances,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.sku.capacity,GreaterThan 1,"resources[0] , resources[0]",32,App Service must be deployed on a minimum of two instances to ensure availability,.\app-service.json
Azure_AppService_Config_Disable_Remote_Debugging,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.remoteDebuggingEnabled | $.properties.remoteDebuggingEnabled,'False',"resources[0] , resources[0]",32,Remote debugging must be turned off for App Service,.\app-service.json
Azure_AppService_Config_Disable_Web_Sockets,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.webSocketsEnabled | $.properties.webSocketsEnabled,'False',"resources[0] , resources[0]",32,Web Sockets should be disabled for App Service,.\app-service.json
Azure_AppService_Deploy_Use_Latest_Version,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Low,Not found,-1,,$.properties.siteConfig.netFrameworkVersion | $.properties.netFrameworkVersion,Allow '^(v4.0|v4.7)$',"resources[0] , resources[0]",32,The latest version of .NET framework version should be used for App Service,.\app-service.json
Azure_AppService_DP_Dont_Allow_HTTP_Access,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,resources[0].properties.httpsOnly,62,FALSE,$.properties.httpsOnly,'True',resources[0],32,App Service must only be accessible over HTTPS,.\app-service.json
Azure_AppService_DP_Use_Secure_TLS_Version,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.minTlsVersion | $.properties.minTlsVersion,GreaterThanOrEqual '1.2',"resources[0] , resources[0]",32,Use approved version of TLS for the App Service,.\app-service.json
Azure_Search_AuthN_Use_Managed_Service_Identity,Search,Failed,Microsoft.Search/searchServices,Medium,Not found,-1,,$.identity.type,Allow 'SystemAssigned',resources[0],77,Use Managed Service Identity (MSI) for accessing other AAD-protected resources from the search service.,.\azure-search.json
Azure_Search_Availability_Configure_Three_Replicas,Search,Failed,Microsoft.Search/searchServices,Medium,Not found,-1,,$.properties.replicaCount,GreaterThan 2,resources[0],75,Search service must have at least three replicas for high availability,.\azure-search.json
Azure_CosmosDB_Config_Default_Consistency,CosmosDb,Failed,Microsoft.DocumentDB/databaseAccounts,High,Not found,-1,,$.properties.consistencyPolicy.defaultConsistencyLevel,NotAllow 'Eventual',resources[0],157,Do not use 'Eventual' consistency,.\cosmos-cassandra.json
Azure_CosmosDB_Deploy_Use_Automatic_Failover,CosmosDb,Failed,Microsoft.DocumentDB/databaseAccounts,Medium,Not found,-1,,$.properties.enableAutomaticFailover,'True',resources[0],165,Use automatic failover,.\cosmos-cassandra.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthSettings.clientId | $.properties.siteAuthSettings.clientId,Non-null string,"resources[0] , resources[1]",131,App Service must authenticate users using Azure Active Directory backed credentials,.\function-app.json
Azure_AppService_Audit_Enable_Logging_and_Monitoring,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.requestTracingEnabled | $.properties.requestTracingEnabled,'True',resources[0],35,Auditing and Monitoring must be enabled for App Service,.\function-app-subnet.json
Azure_AppService_Audit_Enable_Logging_and_Monitoring,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.httpLoggingEnabled | $.properties.httpLoggingEnabled,'True',resources[0],35,Auditing and Monitoring must be enabled for App Service,.\function-app-subnet.json
Azure_AppService_Audit_Enable_Logging_and_Monitoring,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.detailedErrorLoggingEnabled | $.properties.detailedErrorLoggingEnabled,'True',resources[0],35,Auditing and Monitoring must be enabled for App Service,.\function-app-subnet.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthEnabled | $.properties.siteAuthEnabled,'True',resources[0],35,App Service must authenticate users using Azure Active Directory backed credentials,.\function-app-subnet.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthSettings.clientId | $.properties.siteAuthSettings.clientId,Non-null string,resources[0],35,App Service must authenticate users using Azure Active Directory backed credentials,.\function-app-subnet.json
Azure_AppService_AuthN_Use_Managed_Service_Identity,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.identity.type,Allow 'SystemAssigned',resources[0],35,Use Managed Service Identity (MSI) for accessing other AAD-protected resources from the app service.,.\function-app-subnet.json
Azure_AppService_BCDR_Use_AlwaysOn,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.properties.siteConfig.alwaysOn | $.properties.alwaysOn,'True',resources[0],35,'Always On' should be configured for App Service,.\function-app-subnet.json
Azure_AppService_BCDR_Use_Multiple_Instances,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Medium,Not found,-1,,$.sku.capacity,GreaterThan 1,resources[0],35,App Service must be deployed on a minimum of two instances to ensure availability,.\function-app-subnet.json
Azure_AppService_Config_Disable_Remote_Debugging,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.remoteDebuggingEnabled | $.properties.remoteDebuggingEnabled,'False',resources[0],35,Remote debugging must be turned off for App Service,.\function-app-subnet.json
Azure_AppService_Config_Disable_Web_Sockets,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.webSocketsEnabled | $.properties.webSocketsEnabled,'False',resources[0],35,Web Sockets should be disabled for App Service,.\function-app-subnet.json
Azure_AppService_Deploy_Use_Latest_Version,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",Low,Not found,-1,,$.properties.siteConfig.netFrameworkVersion | $.properties.netFrameworkVersion,Allow '^(v4.0|v4.7)$',resources[0],35,The latest version of .NET framework version should be used for App Service,.\function-app-subnet.json
Azure_AppService_DP_Dont_Allow_HTTP_Access,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.httpsOnly,'True',resources[0],35,App Service must only be accessible over HTTPS,.\function-app-subnet.json
Azure_AppService_DP_Use_Secure_TLS_Version,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.minTlsVersion | $.properties.minTlsVersion,GreaterThanOrEqual '1.2',resources[0],35,Use approved version of TLS for the App Service,.\function-app-subnet.json
Azure_AppService_AuthN_Use_AAD_for_Client_AuthN,AppService,Failed,"Microsoft.Web/sites , Microsoft.Web/serverfarms , Microsoft.Web/sites/config",High,Not found,-1,,$.properties.siteConfig.siteAuthSettings.clientId | $.properties.siteAuthSettings.clientId,Non-null string,"resources[0] , resources[1]",139,App Service must authenticate users using Azure Active Directory backed credentials,.\function-app-withredis.json
Azure_LogicApps_AuthZ_Provide_Contents_Access_Control,LogicApps,Failed,Microsoft.Logic/workflows,High,Not found,-1,,$.properties.accessControl.contents.allowedCallerIpAddresses.addressRange,Verify current value,resources[0],15,Must provide IP ranges for contents to prevent unauthorized access to inputs/outputs data of Logic App run history,.\logic-app.json
Azure_LogicApps_AuthZ_Provide_Triggers_Access_Control,LogicApps,Failed,Microsoft.Logic/workflows,High,Not found,-1,,$.properties.accessControl.triggers.allowedCallerIpAddresses.addressRange,Verify current value,resources[0],15,If Logic App fires on an HTTP Request (e.g. Request or Webhook) then provide IP ranges for triggers to prevent unauthorized access,.\logic-app.json
Azure_CosmosDB_AuthZ_Verify_IP_Range,CosmosDb,Verify,Microsoft.DocumentDB/databaseAccounts,High,resources[0].properties.ipRangeFilter,176,"""69.162.0.0/24,69.162.1.0/24,69.162.2.0/24,69.162.16.0/24,104.42.195.92,40.76.54.131,52.176.6.30,52.169.50.45,52.187.184.26,0.0.0.0""",$.properties.ipRangeFilter,Verify current value,resources[0],157,Configure only the required IP addresses on Cosmos DB firewall,.\cosmos-cassandra.json
